<!DOCTYPE html>
<html>
<head>
  <title>QR Code Scanner</title>
  <style>
    #qr-reader {
      width: 100%;
      height: 100%;
    }
    #photo-preview {
      display: none;
    }
    #result-box p {
      margin-bottom: 0;
    }
  </style>
</head>
<body>
  <div id="qr-reader"></div>
  <div id="result-box">
    <p id="result-text"></p>
    <img id="photo-preview" src="" alt="Photo Preview">
  </div>

  <script src="html5-qrcode.min.js"></script>
  <script>
    var html5QrcodeScanner;

    function onScanSuccess(decodedText, decodedResult) {
      // Update the content of the "result-text" element
      document.getElementById('result-text').textContent = decodedText;

      // Take a photo and display it
      takePhoto();

      // Stop the scanner after taking a photo
      html5QrcodeScanner.pause();
    }

    function takePhoto() {
      const video = document.querySelector('video');
      const canvas = document.createElement('canvas');
      canvas.width = video.videoWidth;
      canvas.height = video.videoHeight;
      const context = canvas.getContext('2d');
      context.drawImage(video, 0, 0, canvas.width, canvas.height);
      const photo = canvas.toDataURL('image/jpeg');
      document.getElementById('photo-preview').src = photo;
      document.getElementById('photo-preview').style.display = 'block'; // Show the photo after it's captured
    }

    html5QrcodeScanner = new Html5QrcodeScanner(
      "qr-reader", { fps: 10, qrbox: 250 }
    );
    html5QrcodeScanner.render(onScanSuccess);
  </script>
</body>
</html>
